<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Elephant‚Äôs Dream üêò</title>
  <meta name="description" content="A tiny but polished runner about a cartoon baby elephant in a dreamy world with glowing pillars." />
  <style>
    :root{
      --baby-blue:#BFD9FF; /* baby elephant base */
      --baby-blue-dark:#8EB6FF;
      --line:#4A6DDA;
      --glow:#8AD5FF;
      --star:#FFE8A3;
      --bg-top:#0b0f2a;
      --bg-mid:#1a2150;
      --bg-bottom:#291a4a;
      --ui:#FFFFFF;
      --danger:#FF7B7B;
      --accent:#FFD166;
    }
    html,body{height:100%;margin:0;background:radial-gradient(1200px 800px at 65% 20%, rgba(120,90,255,.25), transparent 60%),
                                     linear-gradient(180deg,var(--bg-top),var(--bg-mid) 55%,var(--bg-bottom));
               color:var(--ui);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;}
    #wrap{display:grid;place-items:center;height:100%;padding:16px}
    canvas{width:min(100vw, 960px);height:calc(min(100vw, 960px)*0.6);display:block;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.6);background:transparent}
    .hud{position:fixed;inset:12px auto auto 12px;display:flex;gap:10px;align-items:center;user-select:none;pointer-events:none}
    .right{left:auto;right:12px}
    .badge{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);backdrop-filter:blur(6px);padding:6px 12px;border-radius:999px;font-size:13px}
    .btnbar{position:fixed;left:0;right:0;bottom:18px;display:flex;justify-content:center;gap:16px}
    .btn{width:72px;height:72px;border-radius:16px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.2);color:#fff;font-weight:700;display:flex;align-items:center;justify-content:center}
    @media (min-width:900px){.btnbar{display:none}}
  </style>
</head>
<body>
  <div id="wrap"><canvas id="game" width="960" height="576" aria-label="Elephant's Dream Game"></canvas></div>
  <div class="hud">
    <div class="badge" id="scoreB">Score: 0</div>
    <div class="badge" id="bestB">Best: 0</div>
    <div class="badge" id="tipsB">Enter to Start ‚Ä¢ Space/‚Üë to Jump ‚Ä¢ ‚Üê ‚Üí to Move ‚Ä¢ P Pause ‚Ä¢ S Sound</div>
  </div>
  <div class="hud right"><div class="badge" id="stateB">Ready</div></div>
  <div class="btnbar" id="mobileCtl">
    <button class="btn" id="leftBtn">‚óÄÔ∏é</button>
    <button class="btn" id="jumpBtn">‚§¥Ô∏é</button>
    <button class="btn" id="rightBtn">‚ñ∂Ô∏é</button>
  </div>

<script>
/* ----------------------------------------------------
   Elephant‚Äôs Dream ‚Äì polished runner with dreamy vibes
   - Cute BABY BLUE cartoon elephant
   - Dreamy parallax sky, twinkling stars, nebula fog
   - Glowing PILLARS as obstacles (soft neon)
   - Smooth keyboard feel (coyote time + jump buffer)
   - Mobile on-screen buttons, pause, sound toggle
   - High score saved locally
---------------------------------------------------- */
const W = 960, H = 576; // internal resolution (CSS scales it)
const c = document.getElementById('game');
const ctx = c.getContext('2d', { alpha:true });
const scoreEl = document.getElementById('scoreB');
const bestEl  = document.getElementById('bestB');
const tipsEl  = document.getElementById('tipsB');
const stateEl = document.getElementById('stateB');

// Audio: tiny oscillator beeps (no external files)
const SFX = (()=>{ let ac; const ensure=()=>ac||(ac=new (window.AudioContext||window.webkitAudioContext)());
  function beep(f=440,t=.08,type='sine',g=.05){const a=ensure();const o=a.createOscillator();const gn=a.createGain();o.type=type;o.frequency.value=f;gn.gain.value=g;o.connect(gn);gn.connect(a.destination);o.start();o.stop(a.currentTime+t);} 
  return { beep, on(){ensure()}, active(){return !!ac} };
})();

// Helpers
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
const rand=(a,b)=>a+Math.random()*(b-a);
const chance=p=>Math.random()<p;

// Input
const keys = {left:false,right:false,jump:false};
let jumpPressedAt = -1; // jump buffer timer
let paused=false, playing=false, over=false;

window.addEventListener('keydown', e=>{
  if(e.repeat) return;
  const k=e.key.toLowerCase();
  if(k==='arrowleft'||k==='a') keys.left=true;
  if(k==='arrowright'||k==='d') keys.right=true;
  if(k===' '||k==='arrowup'||k==='w') { keys.jump=true; jumpPressedAt = performance.now(); }
  if(k==='enter') { if(!playing||over) start(); }
  if(k==='p') { if(playing&&!over) paused=!paused; stateEl.textContent = paused? 'Paused' : 'Playing'; }
  if(k==='s') { SFX.on(); SFX.beep(880,.05,'triangle',.03); tipsEl.textContent='Sound on ‚úì'; setTimeout(()=>tipsEl.textContent='Space/‚Üë Jump ‚Ä¢ ‚Üê ‚Üí Move ‚Ä¢ P Pause ‚Ä¢ S Sound',1200); }
});
window.addEventListener('keyup', e=>{
  const k=e.key.toLowerCase();
  if(k==='arrowleft'||k==='a') keys.left=false;
  if(k==='arrowright'||k==='d') keys.right=false;
  if(k===' '||k==='arrowup'||k==='w') keys.jump=false;
});

// Mobile buttons
const leftBtn=document.getElementById('leftBtn');
const rightBtn=document.getElementById('rightBtn');
const jumpBtn=document.getElementById('jumpBtn');
['mousedown','touchstart'].forEach(ev=>{
  leftBtn.addEventListener(ev,()=>keys.left=true); rightBtn.addEventListener(ev,()=>keys.right=true); jumpBtn.addEventListener(ev,()=>{keys.jump=true; jumpPressedAt=performance.now();});
});
['mouseup','mouseleave','touchend','touchcancel'].forEach(ev=>{
  leftBtn.addEventListener(ev,()=>keys.left=false); rightBtn.addEventListener(ev,()=>keys.right=false); jumpBtn.addEventListener(ev,()=>keys.jump=false);
});

// Game state
const groundY = H*0.78;
let t=0, last=0, dt=0;
let worldSpeed = 220; // scroll speed
let score=0; let best=+localStorage.getItem('elephant_best')||0;

// Stars & fog for dreamy bg
const stars = Array.from({length:120},()=>({x:rand(0,W),y:rand(0,H*0.7),s:rand(0.5,1.8), tw:rand(0.2,0.8)}));
const fogs = Array.from({length:6},()=>({x:rand(0,W),y:rand(40,H*0.6),r:rand(120,240),v:rand(4,10),a:rand(0.05,0.12)}));

// Player: baby elephant (cartoon), baby blue
const ele = { x:140, y:groundY-64, w:78, h:56, vx:0, vy:0, onGround:true, canJump:true,
              maxSpeed:260, acc:1800, decel:2200, jumpVel:-760, gravity:2000,
              coyote:0, coyoteTime:90, jumpBuf:0, jumpBufTime:110, jumping:false };

// Obstacles: glowing pillars
const pillars = []; let spawnTimer=0;
function spawnPillar(){
  // random gap height, pillar width, with glow
  const w = rand(22, 34);
  const h = rand(50, 120);
  const y = groundY - h;
  pillars.push({ x:W + rand(0,80), y, w, h, glow: rand(6, 14), hit:false });
}

// Cute collectible fireflies (bonus points, light)
const flies = []; let flyTimer=0;
function spawnFly(){ flies.push({x:W+rand(0,60), y:rand(groundY-160, groundY-80), r:3.5, a:rand(0.5,1), t:0}); }

function reset(){
  t=0; last=0; dt=0; score=0; worldSpeed=220; over=false; playing=false; paused=false;
  pillars.length=0; flies.length=0;
  ele.x=140; ele.y=groundY-64; ele.vx=0; ele.vy=0; ele.onGround=true; ele.coyote=0; ele.jumpBuf=0; ele.jumping=false;
  spawnTimer=0; flyTimer=0;
  stateEl.textContent='Ready'; scoreEl.textContent='Score: 0'; bestEl.textContent='Best: '+best;
}
reset();

function start(){ if(over) reset(); playing=true; paused=false; stateEl.textContent='Playing'; tipsEl.textContent='Space/‚Üë Jump ‚Ä¢ ‚Üê ‚Üí Move ‚Ä¢ P Pause ‚Ä¢ S Sound'; SFX.beep(660,.06,'sine',.03); }

// Collision helpers
const rectOverlap=(a,b)=> a.x<b.x+b.w && a.x+a.w>b.x && a.y<b.y+b.h && a.y+a.h>b.y;

// Drawing helpers
function RRect(x,y,w,h,r,fill,stroke,shadow){
  ctx.save();
  if(shadow){ ctx.shadowColor=shadow.color; ctx.shadowBlur=shadow.blur; }
  ctx.beginPath();
  ctx.moveTo(x+r,y);
  ctx.arcTo(x+w,y, x+w,y+h, r);
  ctx.arcTo(x+w,y+h, x,y+h, r);
  ctx.arcTo(x,y+h, x,y, r);
  ctx.arcTo(x,y, x+w,y, r);
  ctx.closePath();
  if(fill){ ctx.fillStyle=fill; ctx.fill(); }
  if(stroke){ ctx.lineWidth=2; ctx.strokeStyle=stroke; ctx.stroke(); }
  ctx.restore();
}

function drawElephant(p){
  // body
  RRect(p.x, p.y, p.w, p.h, 18, '#BFD9FF', '#8EB6FF');
  // ear
  RRect(p.x+8, p.y+8, 22, 22, 10, '#D3E5FF', '#9FC0FF');
  // eye
  ctx.fillStyle = '#0b0f2a'; ctx.beginPath(); ctx.arc(p.x+p.w-18, p.y+18, 4, 0, Math.PI*2); ctx.fill();
  // cheek blush
  ctx.fillStyle = 'rgba(255,160,180,.45)'; ctx.beginPath(); ctx.arc(p.x+22, p.y+26, 6, 0, Math.PI*2); ctx.fill();
  // trunk
  RRect(p.x+p.w-14, p.y+20, 16, 18, 6, '#BFD9FF', '#8EB6FF');
  // legs
  RRect(p.x+10, p.y+p.h-10, 16, 10, 5, '#A9C8FF');
  RRect(p.x+32, p.y+p.h-10, 16, 10, 5, '#A9C8FF');
}

function drawBackground(){
  // twinkling stars
  for(const s of stars){
    const tw = (Math.sin((t*0.9)+(s.x*0.03))*.5+.5)*s.tw;
    ctx.globalAlpha = 0.35 + tw*0.65;
    ctx.fillStyle = 'white';
    ctx.beginPath(); ctx.arc(s.x, s.y, s.s, 0, Math.PI*2); ctx.fill();
  }
  ctx.globalAlpha=1;
  // drifting nebula fog
  for(const f of fogs){
    const grad = ctx.createRadialGradient(f.x, f.y, 10, f.x, f.y, f.r);
    grad.addColorStop(0, 'rgba(138,213,255, .20)');
    grad.addColorStop(1, 'rgba(138,213,255, 0)');
    ctx.fillStyle = grad; ctx.beginPath(); ctx.arc(f.x, f.y, f.r, 0, Math.PI*2); ctx.fill();
  }
}

function drawGround(){
  ctx.fillStyle = '#16285a'; ctx.fillRect(0, groundY, W, H-groundY);
  ctx.fillStyle = '#1e3574'; ctx.fillRect(0, groundY-4, W, 4);
}

function drawPillar(p){
  const x=p.x, y=p.y, w=p.w, h=p.h;
  // glow base
  RRect(x-4, y-6, w+8, h+12, 10, 'rgba(138,213,255, .08)', 'rgba(138,213,255,.15)', {color:'rgba(138,213,255,.9)', blur:p.glow});
  // neon core
  const grad = ctx.createLinearGradient(x, y, x, y+h);
  grad.addColorStop(0,'#a9e6ff'); grad.addColorStop(1,'#5bc7ff');
  RRect(x, y, w, h, 8, grad, '#7fd9ff');
  // sparkles
  ctx.fillStyle='rgba(255,255,255,.6)';
  for(let i=0;i<3;i++){ ctx.fillRect(x+rand(3,w-3), y+rand(2,h-2), 1.5, 1.5); }
}

function drawFly(f){
  const g = ctx.createRadialGradient(f.x, f.y, 0.5, f.x, f.y, 8);
  g.addColorStop(0,'rgba(255, 232, 163, 1)');
  g.addColorStop(1,'rgba(255, 232, 163, 0)');
  ctx.fillStyle=g; ctx.beginPath(); ctx.arc(f.x, f.y, 8, 0, Math.PI*2); ctx.fill();
  ctx.globalAlpha=1;
}

function drawUI(){
  // subtle courage bar could be added here; currently score on HUD only
  if(!playing && !over) drawStart();
  if(paused && playing && !over) drawPause();
  if(over) drawOver();
}

function drawStart(){
  ctx.save(); ctx.textAlign='center';
  ctx.fillStyle='rgba(0,0,0,.45)'; ctx.fillRect(W*.08,H*.16,W*.84,H*.5);
  ctx.fillStyle='#fff'; ctx.font='800 44px system-ui, Arial'; ctx.fillText("Elephant‚Äôs Dream", W/2, H*.30);
  ctx.font='400 20px system-ui, Arial';
  const lines=[
    'A baby-blue elephant in a dreamy world‚Ä¶',
    'Use ‚Üê ‚Üí to move, Space/‚Üë to jump. Avoid the glowing pillars.',
    'Comfortable keyboard feel with coyote time (you can still jump just after the edge).',
  ];
  lines.forEach((ln,i)=>ctx.fillText(ln, W/2, H*.38 + i*28));
  ctx.font='700 20px system-ui, Arial'; ctx.fillStyle='#FFD166';
  ctx.fillText('Press Enter to Begin ‚Ä¢ S to enable sound', W/2, H*.60);
  ctx.restore();
}

function drawPause(){
  ctx.save(); ctx.textAlign='center';
  ctx.fillStyle='rgba(0,0,0,.5)'; ctx.fillRect(0,0,W,H);
  ctx.fillStyle='#fff'; ctx.font='800 36px system-ui, Arial'; ctx.fillText('Paused', W/2, H/2);
  ctx.font='400 18px system-ui, Arial'; ctx.fillText('Press P to resume', W/2, H/2+28);
  ctx.restore();
}

function drawOver(){
  ctx.save(); ctx.textAlign='center';
  ctx.fillStyle='rgba(0,0,0,.55)'; ctx.fillRect(W*.08,H*.20,W*.84,H*.46);
  ctx.fillStyle='#fff'; ctx.font='800 40px system-ui, Arial'; ctx.fillText('Dream Again?', W/2, H*.36);
  ctx.font='400 20px system-ui, Arial';
  ctx.fillText(`Final Score: ${Math.floor(score)}`, W/2, H*.43);
  ctx.fillText('Sometimes impossible takes a little courage.', W/2, H*.49);
  ctx.fillStyle='#FFD166'; ctx.font='700 20px system-ui, Arial';
  ctx.fillText('Press Enter to Restart', W/2, H*.57);
  ctx.restore();
}

// Update
function update(now){
  if(!last) last=now; dt = Math.min(0.033, (now-last)/1000); last=now; t += dt;
  if(!playing || paused || over) return;

  // dreamy fog drift
  for(const f of fogs){ f.x -= f.v*dt; if(f.x < -f.r) { f.x = W + f.r; f.y = rand(40,H*0.6);} }

  // spawn cadence
  spawnTimer -= dt; if(spawnTimer<=0){ spawnPillar(); spawnTimer = rand(0.95, 1.5) * (240/worldSpeed); }
  flyTimer -= dt; if(flyTimer<=0){ spawnFly(); flyTimer = rand(0.9, 1.6); }

  // move world
  for(let i=pillars.length-1;i>=0;i--){ const p=pillars[i]; p.x -= worldSpeed*dt; if(p.x + p.w < -10) pillars.splice(i,1); }
  for(let i=flies.length-1;i>=0;i--){ const f=flies[i]; f.x -= worldSpeed*dt*0.9; f.t += dt; f.y += Math.sin(f.t*3)*0.15; if(f.x < -12) flies.splice(i,1); }

  // horizontal input with acceleration
  const target = (keys.left?-1:0) + (keys.right?1:0);
  if(target!==0){ ele.vx = clamp(ele.vx + target*ele.acc*dt, -ele.maxSpeed, ele.maxSpeed); }
  else {
    // decelerate to 0 quickly
    if(Math.abs(ele.vx) < 10) ele.vx = 0; else ele.vx += (ele.vx>0?-1:1)*ele.decel*dt;
  }
  ele.x = clamp(ele.x + ele.vx*dt, 60, W*0.65);

  // gravity
  ele.vy += ele.gravity*dt; ele.y += ele.vy*dt;
  if(ele.y+ele.h >= groundY){ ele.y = groundY-ele.h; ele.vy = 0; if(!ele.onGround){ ele.onGround=true; ele.jumping=false; }
  } else { if(ele.onGround){ ele.onGround=false; ele.coyote = performance.now(); } }

  // jump buffer use + coyote time
  const nowMs = performance.now();
  const canCoyote = (nowMs - ele.coyote) <= ele.coyoteTime; // just left ground
  const buffered = (nowMs - jumpPressedAt) <= ele.jumpBufTime;
  if(buffered && (ele.onGround || canCoyote)){
    // variable jump: stronger if standing still
    ele.vy = ele.jumpVel; ele.onGround=false; ele.jumping=true; jumpPressedAt = -1; if(SFX.active()) SFX.beep(960,.07,'triangle',.035);
  }
  // variable-height jump (release early to cut)
  if(!keys.jump && ele.jumping && ele.vy < -80){ ele.vy = Math.max(ele.vy, -160); ele.jumping=false; }

  // collisions
  for(const p of pillars){
    if(rectOverlap({x:ele.x+8,y:ele.y+6,w:ele.w-16,h:ele.h-10}, p)){
      if(!over){ if(SFX.active()) SFX.beep(220,.25,'sawtooth',.07); over=true; playing=false; stateEl.textContent='Game Over'; best=Math.max(best, Math.floor(score)); localStorage.setItem('elephant_best', best); bestEl.textContent='Best: '+best; }
    }
    // scoring when you pass a pillar
    if(!p.hit && p.x + p.w < ele.x){ p.hit=true; score += 10; if(SFX.active()) SFX.beep(620,.05,'sine',.025); }
  }

  // fireflies collect (bonus)
  for(let i=flies.length-1;i>=0;i--){ const f=flies[i];
    if(Math.hypot((f.x-ele.x-ele.w/2), (f.y-ele.y-ele.h/2)) < 28){ score += 3; if(SFX.active()) SFX.beep(880,.04,'sine',.02); flies.splice(i,1); }
  }

  // difficulty
  worldSpeed = clamp(worldSpeed + 6*dt, 220, 420);
  score += (worldSpeed/240) * dt; // time-based drip
  scoreEl.textContent = 'Score: ' + Math.floor(score);
}

// Render
function render(){
  ctx.clearRect(0,0,W,H);
  drawBackground();
  drawGround();
  // draw entities
  for(const f of flies) drawFly(f);
  for(const p of pillars) drawPillar(p);
  drawElephant(ele);
  drawUI();
}

function loop(now=0){ if(!paused) update(now); render(); requestAnimationFrame(loop); }
requestAnimationFrame(loop);

// mouse/touch start
c.addEventListener('click', ()=>{ if(!playing||over) start(); else paused=!paused; stateEl.textContent = paused? 'Paused' : 'Playing'; });

</script>
</body>
</html>
